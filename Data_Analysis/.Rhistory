Temp <- 'Temp.csv'
chunkSize <- 1000
con <- file(description = Temp,open = 'r')
Temp <- 'fm_bin.dat'
con <- file(description = Temp,open = 'r')
ibrary(openxlsx)
library(reshape2)
library(plyr)
library(scales)
library(ggplot2)
library(devtools)
library(grid)
install_github("vqv/ggbiplot")
install.packages("rlang")
install_github("vqv/ggbiplot")
library(openxlsx)
library(reshape2)
library(plyr)
library(scales)
library(ggplot2)
library(devtools)
library(grid)
install_github("vqv/ggbiplot")
install.packages("vctrs")
install.packages("vctrs")
install_github("vqv/ggbiplot")
library(devtools)
install_github("vqv/ggbiplot")
install.packages('fansi')
install.packages("fansi")
library(devtools)
install_github("vqv/ggbiplot")
library(Maaslin2)
source(file="libraries.R")
?Maaslin2
setwd("C:/Outputs/R_Analysis/MaAsLin2/")
metadata=read.csv("metadata.tsv",sep="\t", header = TRUE, row.names = 1)
source(file="libraries.R")
Path_Abundance=read.csv("humann2pathabundance_cpm.tsv",row.names = 1,sep='\t',header = TRUE)
Gene_Abundance=read.csv("humann2kegg_named_cpm.tsv",row.names = 1,sep='\t',header = TRUE)
Path_Cols=colnames(Path_Abundance)
Gene_Cols=colnames(Gene_Abundance)
row_names_df_to_remove="DSS_treatedp"
metadata=metadata[!(row.names(metadata) %in% row_names_df_to_remove),]
i=0
for(col in Path_Cols){
i=i+1
Path_Cols[i]=gsub("_A.*","",Path_Cols[i])
}
i=0
for(col in Gene_Cols){
i=i+1
Gene_Cols[i]=gsub("_A.*","",Gene_Cols[i])
}
colnames(Path_Abundance)=Path_Cols
colnames(Gene_Abundance)=Gene_Cols
Maaslin2(
Path_Abundance,
metadata,
"Step 3 Path",
fixed_effects = c("RCE_treatment,DSS_treatment,RCEwDSS_only,DSS_only,RCE_only,Sex"),
cores = 4,
)
Maaslin2(
Gene_Abundance,
metadata,
"Step 3 Gene",
fixed_effects = c("RCE_treatment,DSS_treatment,RCEwDSS_only,DSS_only,RCE_only,Sex"),
cores = 4,
)
Maaslin2(
Path_Abundance,
metadata,
"Step 3 Path",
fixed_effects = c("RCEwDSS_only,DSS_only,RCE_only,Sex"),
cores = 4,
)
?Maaslin2
install.packages("vegan")
install.packages("ggplot2")
library(vegan)
Sig_path=read.csv("~/Desktop/Merged_Pathabundance_Table_CPM_meta.tsv", header= TRUE,sep="\t")
Sig_path=read.csv("Merged_Pathabundance_Table_CPM_meta.tsv", header= TRUE,sep="\t")
View(Sig_path)
Table=Sig_path[,2:ncol(Sig_path)-1]
m_com = as.matrix(Table)
nmds = metaMDS(t(m_com), distance = "bray")
plot(nmds)
data.scores = as.data.frame(scores(nmds)$sites)
library(vegan)
Metadata=read.csv("~/Desktop/metadata.csv",sep = ",")
Metadata=read.csv("metadata.tsv",sep = "\t")
View(metadata)
Table=Sig_path[,2:ncol(Sig_path)-1]
m_com = as.matrix(Table)
nmds = metaMDS(t(m_com), distance = "bray")
plot(nmds)
nmds = metaMDS(t(m_com), distance = "bray")
View(m_com)
View(Path_Abundance)
View(Sig_path)
Sig_path=read.csv("Merged_Pathabundance_Table_CPM_meta.tsv", header= TRUE,sep="\t",row.names = 1)
Metadata=read.csv("metadata.tsv",sep = "\t")
Table=Sig_path[,2:ncol(Sig_path)-1]
m_com = as.matrix(Table)
nmds = metaMDS(t(m_com), distance = "bray")
plot(nmds)
data.scores = as.data.frame(scores(nmds)$sites)
data.scores$Treatment_group = Metadata$Treatment_group
data.scores$Samples=Metadata$Sample_ID
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes(  colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes(  colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
data.scores = as.data.frame(scores(nmds)$sites)
data.scores$Treatment_group = Metadata$Treatment_group
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
View(data.scores)
data.scores$Treatment_group = Metadata$Treatment_group
Metadata=read.csv("../output_all/metadata.csv",sep = ",")
Metadata=read.csv("../output_all/metadata.csv",sep = ",")
View(Metadata)
Metadata=read.csv("../output_all/metadata.csv",sep = ",",row.names = 1)
View(Metadata)
Table=Sig_path[,2:ncol(Sig_path)-1]
m_com = as.matrix(Table)
nmds = metaMDS(t(m_com), distance = "bray")
plot(nmds)
data.scores = as.data.frame(scores(nmds)$sites)
data.scores$Treatment_group = Metadata$Treatment_group
data.scores$Samples=Metadata$Sample_ID
Metadata[-"Start",]
Metadata[-c("Start"),]
Metadata[-c(17),]
Metadata=Metadata[-c(17),]
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
Metadata=read.csv("../output_all/metadata.csv",sep = ",",row.names = 1)
Table=Sig_path[,2:ncol(Sig_path)-1]
m_com = as.matrix(Table)
nmds = metaMDS(t(m_com), distance = "bray")
plot(nmds)
Metadata=Metadata[-c(17),]
data.scores = as.data.frame(scores(nmds)$sites)
data.scores$Treatment_group = Metadata$Treatment_group
data.scores$Samples=Metadata$Sample_ID
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
View(Metadata)
data.scores$Samples=Metadata$Sample_ID
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
Metadata$Sample_ID
Metadata=read.csv("../output_all/metadata.csv",sep = ",")
View(Metadata)
Table=Sig_path[,2:ncol(Sig_path)-1]
m_com = as.matrix(Table)
nmds = metaMDS(t(m_com), distance = "bray")
plot(nmds)
Metadata=Metadata[-c(17),]
data.scores = as.data.frame(scores(nmds)$sites)
data.scores$Treatment_group = Metadata$Treatment_group
data.scores$Samples=Metadata$Sample_ID
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9","#56B4E9"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#E69F00", "#023020","#56B4E9"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#E69F00", "#023020","#4C9A2A"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#4C9A2A", "#023020","#4C9A2A"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#4C9A2A", "#1F75FE","#4C9A2A"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#4C9A2A", "#1F75FE","#a000c8"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
Sig_taxa=read.csv("megan/rel_freqs.csv", header= TRUE,sep=",",row.names = 1)
Metadata=read.csv("../output_all/metadata.csv",sep = ",")
Metadata=Metadata[-c(7,8,9,10,17),]
View(Sig_taxa)
View(Sig_taxa)
Sig_path[,2:ncol(Sig_path)]
Sig_taxa[,2:ncol(Sig_taxa)]
Table=Sig_taxa[,1:ncol(Sig_taxa)]
m_com = as.matrix(Table)
nmds = metaMDS(t(m_com), distance = "bray")
plot(nmds)
Metadata=Metadata[-c(17),]
data.scores = as.data.frame(scores(nmds)$sites)
data.scores$Treatment_group = Metadata$Treatment_group
data.scores$Samples=Metadata$Sample_ID
library(ggplot2)
xx = ggplot(data.scores, aes(x = NMDS1, y = NMDS2)) +
geom_point(size = 4, aes( colour = Treatment_group))+
scale_color_manual(values=c("#999999", "#4C9A2A", "#1F75FE","#a000c8"))+
geom_text(aes(label=Samples), size=3,nudge_y = 0.02 )
xx
source("~/Desktop/Academics/Projects/RCE_Megtagenomics/Data_Analysis/NMDS.R")
