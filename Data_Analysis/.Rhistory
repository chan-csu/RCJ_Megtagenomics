Temp <- 'Temp.csv'
chunkSize <- 1000
con <- file(description = Temp,open = 'r')
Temp <- 'fm_bin.dat'
con <- file(description = Temp,open = 'r')
ibrary(openxlsx)
library(reshape2)
library(plyr)
library(scales)
library(ggplot2)
library(devtools)
library(grid)
install_github("vqv/ggbiplot")
install.packages("rlang")
install_github("vqv/ggbiplot")
library(openxlsx)
library(reshape2)
library(plyr)
library(scales)
library(ggplot2)
library(devtools)
library(grid)
install_github("vqv/ggbiplot")
install.packages("vctrs")
install.packages("vctrs")
install_github("vqv/ggbiplot")
library(devtools)
install_github("vqv/ggbiplot")
install.packages('fansi')
install.packages("fansi")
library(devtools)
install_github("vqv/ggbiplot")
library(Maaslin2)
source(file="libraries.R")
?Maaslin2
setwd("C:/Outputs/R_Analysis/MaAsLin2/")
metadata=read.csv("metadata.tsv",sep="\t", header = TRUE, row.names = 1)
source(file="libraries.R")
Path_Abundance=read.csv("humann2pathabundance_cpm.tsv",row.names = 1,sep='\t',header = TRUE)
Gene_Abundance=read.csv("humann2kegg_named_cpm.tsv",row.names = 1,sep='\t',header = TRUE)
Path_Cols=colnames(Path_Abundance)
Gene_Cols=colnames(Gene_Abundance)
row_names_df_to_remove="DSS_treatedp"
metadata=metadata[!(row.names(metadata) %in% row_names_df_to_remove),]
i=0
for(col in Path_Cols){
i=i+1
Path_Cols[i]=gsub("_A.*","",Path_Cols[i])
}
i=0
for(col in Gene_Cols){
i=i+1
Gene_Cols[i]=gsub("_A.*","",Gene_Cols[i])
}
colnames(Path_Abundance)=Path_Cols
colnames(Gene_Abundance)=Gene_Cols
Maaslin2(
Path_Abundance,
metadata,
"Step 3 Path",
fixed_effects = c("RCE_treatment,DSS_treatment,RCEwDSS_only,DSS_only,RCE_only,Sex"),
cores = 4,
)
Maaslin2(
Gene_Abundance,
metadata,
"Step 3 Gene",
fixed_effects = c("RCE_treatment,DSS_treatment,RCEwDSS_only,DSS_only,RCE_only,Sex"),
cores = 4,
)
Maaslin2(
Path_Abundance,
metadata,
"Step 3 Path",
fixed_effects = c("RCEwDSS_only,DSS_only,RCE_only,Sex"),
cores = 4,
)
?Maaslin2
